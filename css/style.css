/* =====================================================
   Base & tokens
===================================================== */
*{ box-sizing:border-box }
html{ scroll-behavior:smooth }
body{ margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif; color:#111 }

/* Variables globales */
:root{
  /* Sol & plateformes (header) */
  --gH: 21svh;                                   /* hauteur du sol */
  --tile: url("../assets/bg/blue-tile.png");
  --tileSize: 64px;
  --holeW: clamp(60px, 14vw, 220px);             /* largeur du trou */

  --tiles: url("../assets/bg/plat.png");
  --tilesSize: 64px;

  /* Grotte */
  --caveGroundH: 7svh;
  --caveTile: url("../assets/bg/cave-tile.png");
  --caveTileSize: 64px;

  /* Titres 2D */
  --m-face:#ffe9d3;
  --m-outline:#5a2b16;
  --m-shadow:#000000;
  --m-stroke:3px;
  --m-off:6px;
}

/* upsample léger de la tuile grotte sur mobile pour lisibilité */
@media (max-width:700px){ :root{ --caveTileSize: 72px; } }

/* =====================================================
   HEADER / CIEL
===================================================== */
.top-hero{
  position:relative;
  min-height:100svh; /* "svh" gère la barre d'adresse mobile */
  display:flex; align-items:center; justify-content:center;
  background: url("../assets/bg/sky.png") center / cover no-repeat;
  overflow:hidden;
  padding-top: max(16px, env(safe-area-inset-top));
}

.top-hero::before{ /* nuages en léger parallax */
  content:""; position:absolute; inset:0; z-index:0;
  background: url("../assets/bg/clouds.png") repeat-x center 18% / auto 100%;
}

/* zones de contrôles */
.controls{ position:absolute; top:16px; display:flex; gap:10px; z-index:5 }
.controls.left{ left:16px }
.controls.right{ right:16px }

/* =====================================================
   Cloud buttons (Game / Mouse)
===================================================== */
.mode-toggle{ display:flex; gap:clamp(8px,2.4vw,14px); padding-top: clamp(8px, 6vw, 50px); }

.chip{
  --w: clamp(96px, 22vw, 200px);
  --h: clamp(36px, 8vw, 56px);
  position: relative;
  display: grid; place-items: center;
  width: var(--w); height: var(--h);
  padding-inline: 12px;
  border: none;
  background: url("../assets/bg/cloudBtn.png") center / 100% 100% no-repeat;
  color: #1c2538; font-weight: 700;
  font-size: clamp(12px, 3.6vw, 16px);
  line-height:1; text-shadow: 0 2px 0 #ffffffaa;
  cursor: pointer; user-select: none; -webkit-tap-highlight-color: transparent;
  transition: transform .12s ease, filter .12s ease, box-shadow .12s ease;
}
.chip.active{ filter: drop-shadow(0 6px 12px rgba(0,0,0,.25)); }
.chip:hover{ transform: translateY(-2px) }
.chip:active{ transform: translateY(2px) }
.chip:focus-visible{ outline: 2px solid #fff; outline-offset: 2px; box-shadow: 0 0 0 3px #1c5cff88 }

@media (max-width:520px){
  .mode-toggle{ gap:10px }
}

/* =====================================================
   Boutons "?" (question blocks)
===================================================== */
.q-actions{
  display:flex;
  gap: clamp(8px, 4vw, 24px);
  padding-top: clamp(12px, 10vw, 100px);
  padding-right: clamp(8px, 5vw, 50px);
}

.qbtn{
  --s: clamp(44px, 7vw, 70px);
  --pad: 8px; --r: 2px; --r2: 2px;
  --screwDark:#000; --screwLight:#000;
  --body:#f3a562; --border:#c85d32;
  --qSize: clamp(18px, 4.5vw, 50px);
  --qColor:#c85d32; --qOutline:#5c2a10;
  --qDropX:2px; --qDropY:2px; --qDrop:rgba(0,0,0,1);

  position:relative; display:inline-grid; place-items:center;
  width:var(--s); height:var(--s); border-radius:8px;
  background:var(--body); border:3px solid var(--border);
  box-shadow:0 6px 0 #000, 0 12px 24px rgba(0,0,0,.35);
  transform:translateY(0);
}
.qbtn::before{
  content:""; position:absolute; inset:3px; border-radius:6px;
  border:0 solid #ffd8a8; opacity:.9; pointer-events:none;
}
.qbtn::after{
  content:""; position:absolute; inset:0; pointer-events:none;
  background:
    radial-gradient(circle var(--r)  at var(--pad) var(--pad),                 var(--screwDark) 99%, transparent),
    radial-gradient(circle var(--r2) at var(--pad) var(--pad),                 var(--screwLight) 99%, transparent),
    radial-gradient(circle var(--r)  at calc(100% - var(--pad)) var(--pad),   var(--screwDark) 99%, transparent),
    radial-gradient(circle var(--r2) at calc(100% - var(--pad)) var(--pad),   var(--screwLight) 99%, transparent),
    radial-gradient(circle var(--r)  at var(--pad) calc(100% - var(--pad)),   var(--screwDark) 99%, transparent),
    radial-gradient(circle var(--r2) at var(--pad) calc(100% - var(--pad)),   var(--screwLight) 99%, transparent),
    radial-gradient(circle var(--r)  at calc(100% - var(--pad)) calc(100% - var(--pad)), var(--screwDark) 99%, transparent),
    radial-gradient(circle var(--r2) at calc(100% - var(--pad)) calc(100% - var(--pad)), var(--screwLight) 99%, transparent);
}
.qbtn .q{
  font-family:"Press Start 2P", system-ui, monospace;
  font-size:var(--qSize);
  line-height:1; user-select:none; color:var(--qColor);
  text-shadow:
    1px 0   var(--qOutline), -1px 0   var(--qOutline),
    0   1px var(--qOutline),  0   -1px var(--qOutline),
    1px 1px var(--qOutline), -1px 1px var(--qOutline),
    1px -1px var(--qOutline),-1px -1px var(--qOutline),
    var(--qDropX) var(--qDropY) 0 var(--qDrop);
}
.qbtn:hover{ transform:translateY(-2px); box-shadow:0 8px 0 #c85d32, 0 16px 28px rgba(0,0,0,.45) }
.qbtn:active{ transform:translateY(2px);  box-shadow:0 3px 0 #c85d32, 0 8px 14px rgba(0,0,0,.25) }
.qbtn:where(:link, :visited, :hover, :active){ color:inherit; text-decoration:none !important }

/* =====================================================
   Panneau titre
===================================================== */
.title-banner{
  position:relative;
  padding: clamp(14px, 3.2vw, 26px) clamp(18px, 3.8vw, 38px);
  border-radius:12px;
  background:#c85d32; border:2px solid #7c2d12; color:#fff; text-align:center;
  box-shadow:0 12px 28px rgba(0,0,0,.25); z-index:1
}
.title-banner .pins::before,
.title-banner .pins::after{
  content:""; position:absolute; width:10px; height:10px;
  background:#ffd9b3; border:2px solid #7c2d12; border-radius:999px; top:8px;
}
.title-banner .pins::before{ left:8px } .title-banner .pins::after{ right:8px }
.title-banner::before, .title-banner::after{
  content:""; position:absolute; width:10px; height:10px;
  background:#ffd9b3; border:2px solid #7c2d12; border-radius:999px; bottom:8px
}
.title-banner::before{ left:8px } .title-banner::after{ right:8px }

.title{
  margin:0;
  font-family:"Anton", system-ui, sans-serif;
  font-weight:400;
  font-size:clamp(32px, 7vw, 60px);
  line-height:1.08;
  letter-spacing:.01em;
  text-transform:uppercase;
  text-align:left;
}
.title-3d{
  position:relative;
  color:var(--m-face);
  -webkit-text-stroke:var(--m-stroke) var(--m-outline);
  text-shadow: var(--m-off) var(--m-off) 0 var(--m-shadow);
}
.title-3d::after{ content:none }
.title.taller{ display:inline-block; transform:scaleY(1.5); transform-origin:center bottom; line-height:.95; letter-spacing:.005em }
.title-3d.taller{ --m-stroke: 2.6px; --m-off: 5px }
.title.smaller{ padding-bottom:.8em }

/* =====================================================
   Sol & plateformes (header)
===================================================== */
.ground-bar{
  position:absolute; left:0; right:0; bottom:0;
  height:var(--gH);
  display:grid; grid-template-columns: 1fr var(--holeW) 1fr;
  z-index:1;
}
.seg{ background: var(--tile) repeat left bottom / var(--tileSize) var(--tileSize); image-rendering: pixelated }
.gap{ background: transparent }

.platform{
  position:absolute;
  background: var(--tiles) repeat left bottom / var(--tilesSize) var(--tilesSize);
  image-rendering: pixelated;
  z-index: 1;
  pointer-events: none; border: none; outline:none; box-shadow:none;
}
.platform.p2{
  width: clamp(140px, 20vw, 360px);
  height: 7svh;
  right: clamp(12px, 5vw, 5vw);
  bottom: calc(var(--gH) + 24svh);
  border-top-left-radius: 8px; border-top-right-radius: 8px;
}
@media (max-width:900px){
  .platform.p2{ width: clamp(160px, 26vw, 300px); right: 6vw; bottom: calc(var(--gH) + 26svh); }
}

/* =====================================================
   Hero wrapper & CTA
===================================================== */
.hero-center{
  --ctaPush: clamp(40px, 8vw, 100px);
  position: relative;
  display:flex; flex-direction:column; align-items:center; gap:14px;
  transform: translateY(-20svh);
  z-index:2;
}
.title-banner{ transform:none }

.who-btn{
  --pad: 12px 18px; --bg:#f3a562; --bd:#c85d32;
  display:inline-block; padding: var(--pad); border-radius:10px;
  background: var(--bg); border:3px solid var(--bd);
  color:#1e2438; font-weight:800; text-decoration:none; letter-spacing:.02em;
  box-shadow: 0 6px 0 #0008, 0 14px 28px #0004;
  transform: translateY(var(--ctaPush));
  transition: transform .12s ease, box-shadow .12s ease;
}
.who-btn:hover{ transform: translateY(calc(var(--ctaPush) - 2px)); box-shadow: 0 8px 0 #0008, 0 16px 30px #0005 }
.who-btn:active{ transform: translateY(calc(var(--ctaPush) + 2px)); box-shadow: 0 3px 0 #0008, 0 10px 20px #0003 }

.who-arrow{ width: clamp(18px, 6vw, 40px); height: clamp(18px, 6vw, 40px); position: relative; opacity:.9; transform: translateY(calc(var(--ctaPush) + 10px)); }
.who-arrow::before{ content:""; position:absolute; inset:0; border-right:4px solid #1e2438; border-bottom:4px solid #1e2438; transform: rotate(45deg); animation: bounceDown 1.2s ease-in-out infinite }
@keyframes bounceDown{ 0%,100%{ transform: translateY(0) rotate(45deg); opacity:.95 } 50%{ transform: translateY(8px) rotate(45deg); opacity:.6 } }

@media (max-width:700px){ .hero-center{ gap:10px; transform: translateY(-18svh) } }

/* =====================================================
   Canvas overlay
===================================================== */
.game-layer{ position:absolute; inset:0; width:100%; height:100%; pointer-events:none; z-index:3 }
@media (max-width:700px){ .game-layer{ image-rendering: pixelated } }

/* =====================================================
   Panneau d'aide
===================================================== */
.help-chip{
  position:absolute; left:16px; top:16px; z-index:6;
  width:36px; height:36px; border-radius:999px; border:0;
  font-weight:800; background:#fff; color:#1e2438;
  box-shadow:0 6px 16px rgba(0,0,0,.25);
  cursor:pointer; user-select:none;
}
.help-chip:hover{ transform:translateY(-1px) }
.help-chip:active{ transform:translateY(1px) }

.controls-hints{
  position:absolute; left:16px; bottom:16px; z-index:6;
  display:flex; gap:16px; align-items:flex-end;
  padding:12px 14px; border-radius:12px;
  background:rgba(0,0,0,.45); backdrop-filter: blur(4px);
  color:#f4f7ff; box-shadow:0 8px 24px rgba(0,0,0,.25);
  opacity:0; transform:translateY(8px); pointer-events:none;
  transition: opacity .25s ease, transform .25s ease;
}
.controls-hints.show{ opacity:1; transform:translateY(0); pointer-events:auto; }
.controls-hints .hint{ margin:0; text-align:center }
.controls-hints .hint img{ display:block; image-rendering:auto; }
.controls-hints .hint figcaption{ font-size:12px; opacity:.95; margin-top:6px; }
.controls-hints .hint-note{ margin:0 0 6px 6px; font-size:12px; opacity:.85; }
@media (max-width:700px){
  .controls-hints{ left:12px; right:12px; bottom:12px; flex-wrap:wrap; justify-content:center }
}

/* =====================================================
   Pop items (icônes qui sortent des ?)
===================================================== */
.pop-items-layer{ position:absolute; inset:0; pointer-events:none; z-index:6 }
.pop-item{
  position:absolute; width:56px; height:56px;
  display:grid; place-items:center;
  background:#0c1224; border:3px solid #5aa2ff; border-radius:12px;
  box-shadow: 0 8px 20px rgba(0,0,0,.45);
  transform: translate(-50%, -100%); animation: popUp .35s ease-out forwards;
  pointer-events:auto; cursor:pointer;
}
.pop-item:hover{ transform: translate(-50%, -100%) scale(1.05) }
.pop-item:active{ transform: translate(-50%, -98%) scale(0.98) }
.pop-item .label{ position:absolute; top:-22px; left:50%; transform:translateX(-50%); background:#000a; color:#fff; font-size:12px; padding:2px 6px; border-radius:6px }
@keyframes popUp{ 0%{ opacity:0; translate:0 6px } 100%{ opacity:1; translate:0 -10px } }
.qbtn.hit{ transform: translateY(4px); box-shadow:0 3px 0 #000, 0 8px 18px rgba(0,0,0,.30) }
.qbtn.hit:after{ content:""; position:absolute; inset:0; border-radius:8px; box-shadow:0 0 0 3px #fff inset; animation: flash .15s linear }
@keyframes flash{ from{opacity:.8} to{opacity:0} }
.pop-item svg{ width:28px; height:28px; display:block }
.pop-item.github svg{ fill:#fff } .pop-item.mail svg{ fill:#ffe082 } .pop-item.cv svg{ fill:#7ef4ff } .pop-item.linkedin svg{ fill:#58a6ff } .pop-item.itch svg{ fill:#ff4d6d }

/* =====================================================
   SECTION 2 : Grotte
===================================================== */
.about-cave{
  min-height: 100svh;
  position: relative;
  display:grid; place-items:center;
  padding: clamp(24px, 6vw, 64px);
  color:#f3f6ff;
  overflow:hidden;
  background: url("../assets/bg/caveBackground.png") center / cover no-repeat fixed;
}
/* éviter le jank mobile */
@media (max-width:900px){ .about-cave{ background-attachment: scroll } }

.about-cave::before{
  content:"";
  position:absolute; inset:0;
  background: linear-gradient(180deg, #00000066, #00000099);
}

.about-wrap{
  position: relative; z-index: 3;   /* au-dessus du canvas en mobile */
  max-width: 900px; text-align: center;
}

.about-title{
  font-family: "Anton", system-ui, sans-serif;
  font-size: clamp(28px, 6vw, 64px);
  letter-spacing: .02em;
  margin: 0 0 .6em;
  text-shadow: 0 4px 0 #000, 0 10px 24px rgba(0,0,0,.45);
}

.about-text{
  font-size: clamp(16px, 2.2vw, 20px);
  line-height: 1.7;
  margin: 0 auto;
  text-wrap: balance;
  max-width: 70ch;
  text-shadow: 0 2px 0 #000;
}

.cave-ground{
  position:absolute; left:0; right:0; bottom:0;
  height: var(--caveGroundH);
  background: var(--caveTile) repeat left bottom / var(--caveTileSize) var(--caveTileSize);
  image-rendering: pixelated;
  z-index: 0;
  box-shadow: inset 0 10px 18px rgba(0,0,0,.25);
  border-top: 1px solid rgba(0,0,0,.15);
}

/* Bouton retour */
.back-btn{
  --pad: 12px 18px; --bg:#9fd1ff; --bd:#2f5e91;
  top:100px; left:50%;
  position:absolute; display:inline-block;
  margin-top: 18px; padding: var(--pad);
  border-radius: 10px; background: var(--bg);
  border: 3px solid var(--bd); color: #102033;
  font-weight: 800; text-decoration: none; letter-spacing: .02em;
  box-shadow: 0 6px 0 #0008, 0 14px 28px #0004;
  transform:translateX(-50%);
  transition: transform .12s ease, box-shadow .12s ease;
}
.back-btn:hover{ transform:translateX(-50%) translateY(-2px); box-shadow:0 8px 0 #0008, 0 16px 30px #0005 }
.back-btn:active{ transform:translateX(-50%) translateY(2px);  box-shadow:0 3px 0 #0008, 0 10px 20px #0003 }

.back-arrow.up{
  position:absolute; top:62px; left:50%; transform:translateX(-50%);
  width: clamp(18px, 6vw, 40px); height: clamp(18px, 6vw, 40px); opacity:.9;
}
.back-arrow.up::before{
  content:""; position:absolute; inset:0;
  border-left:4px solid #fff; border-top:4px solid #fff;
  transform:rotate(45deg); animation:bounceUp 1.2s ease-in-out infinite;
}
@keyframes bounceUp{
  0%,100%{ transform:translateY(0) rotate(45deg); opacity:.95 }
  50%    { transform:translateY(-8px) rotate(45deg); opacity:.6 }
}

/* Toggles d'info (about) */
.info-toggle{
  position: absolute; top: 100px; z-index: 5;
  max-width: min(44ch, 92vw);
}
.info-toggle.left  { left: clamp(12px, 6vw, 100px); }
.info-toggle.right { right: clamp(12px, 6vw, 100px); text-align: right; }

.info-head{
  --bg: rgba(12,16,28,.85); --bd: #2c395a; --fg: #fff;
  display: inline-flex; align-items: center; gap: 10px;
  padding: 10px 14px; border-radius: 999px;
  border: 2px solid var(--bd); background: var(--bg); color: var(--fg);
  font-weight: 800; letter-spacing: .02em; cursor: pointer;
  text-shadow: 0 2px 0 #000; box-shadow: 0 8px 18px rgba(0,0,0,.35);
}
.info-head:focus-visible{ outline: 2px solid #fff; outline-offset: 2px; }
.info-head .chev{
  width: 10px; height: 10px; display: inline-block;
  border-right: 3px solid var(--fg); border-bottom: 3px solid var(--fg);
  transform: rotate(45deg); transition: transform .25s ease;
}
.info-head[aria-expanded="true"] .chev{ transform: rotate(-135deg); }

.info-panel{
  --pad: 14px;
  margin-top: 10px; background: rgba(10,12,20,.78);
  border: 2px solid #2c395a; border-radius: 12px;
  box-shadow: 0 12px 28px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.05);
  overflow: hidden; max-height: 0; opacity: 0; transform: translateY(-4px);
  transition: max-height .45s ease, opacity .28s ease, transform .28s ease;
}
.info-panel:not([hidden]){ padding: var(--pad); }
.info-panel.open{ max-height: 520px; opacity: 1; transform: translateY(0); }

.info-title{
  margin: 0 0 .5rem; font-family: "Anton", system-ui, sans-serif;
  font-size: clamp(20px, 3.2vw, 28px);
  color: #ffd166; text-shadow: 0 2px 0 #000;
}
.info-list{
  margin: 0; padding-left: 1.1em;
  display: grid; gap: .35rem;
  font-size: clamp(14px, 2.1vw, 16px); line-height: 1.6;
}
.info-list li::marker{ color:#ffd166 }

/* =====================================================
   MOBILE-ONLY ADJUSTMENTS
===================================================== */

/* HEADER — sur mobile : rangée plus basse + tailles réduites + icônes pop plus petites */
@media (max-width:700px){
  :root{
    --qS: 42px;           /* taille carrés ? (réduit) */
    --headRowTop: 76px;   /* rangée abaissée (64–84 selon goût) */
    --popOffsetY: 12px;   /* décalage pop vers le bas */
  }

  .qbtn{ --s: var(--qS); }

  .controls.right{ top: var(--headRowTop); right:16px; left:auto; }
  .q-actions{ gap:10px; padding-top:0; padding-right:0; }

  /* Game/Mouse même hauteur, à gauche des ? */
  .controls.left{
    top: var(--headRowTop); left:auto;
    right: calc(16px + (var(--qS) * 4) + (10px * 3)); /* 4 cases + 3 gaps */
  }

  .mode-toggle{ gap:8px; padding-top:0; }
  .mode-toggle .chip{ --w: 88px; --h: 34px; font-size:12px; }

  /* pop plus petits */
  .pop-item{
    width: 44px; height: 44px;
    border-width: 2px; border-radius: 10px;
    box-shadow: 0 6px 16px rgba(0,0,0,.35);
  }
  .pop-item svg{ width: 22px; height: 22px; }
  .pop-item:hover{  transform: translate(-50%, -100%) scale(1.03); }
  .pop-item:active{ transform: translate(-50%,  -98%) scale(0.97); }
}

/* très petit tel (ex. 360px) : un cran de moins */
@media (max-width:380px){
  :root{ --qS: 38px; }
  .mode-toggle .chip{ --w: 80px; --h: 30px; font-size:11px; }
  .pop-item{ width: 40px; height: 40px; }
  .pop-item svg{ width: 20px; height: 20px; }
}

/* ABOUT — ordre mobile: back | toggles | bloc who I am + centrage + texte devant le canvas */
@media (max-width:700px){
  #about.about-cave{
    display:grid;
    grid-template-columns: 1fr 1fr;
    grid-template-areas:
      "back back"
      "togL togR"
      "about about";
    row-gap:10px;
    align-items:start;
    padding-top:24px;
  }

  /* bouton bien centré */
  #about .back-btn{ position:static; grid-area: back; margin-inline:auto; }
  /* flèche en absolu, ne décale pas le bouton */
  #about .back-arrow.up{
    position:absolute; top:58px; left:50%; transform:translateX(-50%); margin:0;
  }

  /* toggles */
  #about .info-toggle{ max-width: 100%; }
  #about .info-toggle.left  { position:static; grid-area: togL; justify-self:start; }
  #about .info-toggle.right { position:static; grid-area: togR; justify-self:end; text-align:left; }

  /* contenu Who I am au-dessus du canvas + léger lift */
  #about .about-wrap{ grid-area: about; z-index:3; margin-top:-6px; }
  #about .game-layer{ z-index:1; }   /* canvas sous le texte */
  #about .cave-ground{ z-index:0; }
}

/* =====================================================
   Accessibilité motion
===================================================== */
@media (prefers-reduced-motion: reduce){
  .who-arrow::before, .back-arrow.up::before{ animation:none }
}

/* === Abaisser le panneau-titre (header) === */
:root{
  --titleDrop: 14px;   /* desktop : descendre de ~24px (ajuste à ton goût) */
}

@media (max-width:700px){
  :root{
    --titleDrop: 32px; /* mobile : un peu plus bas ; mets 28–40px si besoin */
  }
}

/* on applique un décalage AU SEUL panneau-titre */
.hero-center .title-banner{
  transform: translateY(var(--titleDrop)) !important;
}

/* ===== Back to start centré (mobile) ===== */
/* --- FIX: Back to start cliquable et centré (mobile) --- */
@media (max-width:700px){
  :root{ --backBtnOffset: -65px; } /* ajuste 32–56 si tu veux plus bas */

  /* centre + passe au-dessus du reste */
  #about .back-btn{
    grid-area: back;
    position: relative !important; /* crée un contexte pour z-index */
    z-index: 3;
    left: auto !important;
    transform: none !important;
    display: inline-block;
    justify-self: center;
    margin: var(--backBtnOffset) auto 8px auto !important; /* << le ; était manquant avant */
  }

  /* la flèche ne prend plus les clics, reste derrière */
  #about .back-arrow.up{
    position: absolute;
    top: 40px;                      /* ajuste si besoin */
    left: 50%;
    transform: translateX(-50%);
    margin: 0;
    z-index: 2;                     /* sous le bouton */
    pointer-events: none;           /* <- ne capte plus le clic */
  }
}

/* === Lifter "Who I am" (mobile only) === */
@media (max-width:700px){
  :root{ --whoLift: 90px; } /* augmente à 32–40px si tu veux plus haut */

  #about .about-wrap{
    margin-top: calc(-1 * var(--whoLift)) !important; /* remonte le bloc titre+texte */
  }

  /* (option) resserrer un peu l’espace sous le titre */
  #about .about-title{
    margin-bottom: 0.4em;
  }
}

